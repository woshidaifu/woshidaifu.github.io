---
layout: archive
title: "nginx : 日志排查"
categories:
  - nginx
tags:
  - nginx
  - php
  - php-fpm
---
## 问题描述：nginx排错

* 某只交易进来后，日志只打了req的内容，之后交易就直接报错返回，应用中没有其他报错日志了。

## 原因排查：
1. 讲请求参数使用格式化后，在本地断点调试，发现请求正常返回。
2. 注意到数据量较大， 本地执行超过10s。猜测是nginx超时，或者php-fpm处理超时。
3. 但是以报文形式请求的时候，大概2s-3s左右就返回报错，nginx的配置超时一般在60s左右。
4. 继续检查nginx的日志，发现具体的log中有php返回内容过多导致内存耗尽的报错，至此查到报错原因。

## 问题解决方案：
* 因此，调整php.ini中内存128m的限制

## 一点想法不一定对
* 任何报错都有迹可循